[2025-06-08T22:49:37.184+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-08T22:49:37.217+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-08T22:49:37.220+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-08T22:49:37.220+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-08T22:49:37.236+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-06 00:00:00+00:00
[2025-06-08T22:49:37.238+0200] {standard_task_runner.py:63} INFO - Started process 1186614 to run task
[2025-06-08T22:49:37.240+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-06T00:00:00+00:00', '--job-id', '287', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmpz3lyo1wl']
[2025-06-08T22:49:37.240+0200] {standard_task_runner.py:91} INFO - Job 287: Subtask format_daily_data_all_cities
[2025-06-08T22:49:37.296+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-08T22:49:37.355+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-06T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-06T00:00:00+00:00'
[2025-06-08T22:49:37.356+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-08T22:49:37.357+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-06
[2025-06-08T22:49:41.108+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-08T22:49:41.114+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 37 cities from config
[2025-06-08T22:49:41.114+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-08T22:49:41.114+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-06.json
[2025-06-08T22:49:41.117+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:41.122+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:44.616+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-08T22:49:44.617+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-06.json
[2025-06-08T22:49:44.618+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:45.314+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-08T22:49:45.314+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-08T22:49:45.315+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-06.json
[2025-06-08T22:49:45.317+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:45.323+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:45.826+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-08T22:49:45.826+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-06.json
[2025-06-08T22:49:45.830+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:46.349+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-08T22:49:46.349+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: london
[2025-06-08T22:49:46.349+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/london/2025-06-06.json
[2025-06-08T22:49:46.350+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:46.353+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:46.864+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for london
[2025-06-08T22:49:46.864+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/london/2025-06-06.json
[2025-06-08T22:49:46.865+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:47.313+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for london
[2025-06-08T22:49:47.314+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: saint_petersburg
[2025-06-08T22:49:47.314+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/saint_petersburg/2025-06-06.json
[2025-06-08T22:49:47.315+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:47.317+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:47.703+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for saint_petersburg
[2025-06-08T22:49:47.703+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/saint_petersburg/2025-06-06.json
[2025-06-08T22:49:47.706+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:48.143+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for saint_petersburg
[2025-06-08T22:49:48.143+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: berlin
[2025-06-08T22:49:48.143+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/berlin/2025-06-06.json
[2025-06-08T22:49:48.144+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:48.147+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:48.645+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for berlin
[2025-06-08T22:49:48.645+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/berlin/2025-06-06.json
[2025-06-08T22:49:48.648+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:49.048+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for berlin
[2025-06-08T22:49:49.049+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: madrid
[2025-06-08T22:49:49.049+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/madrid/2025-06-06.json
[2025-06-08T22:49:49.051+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:49.055+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:49.527+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for madrid
[2025-06-08T22:49:49.528+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/madrid/2025-06-06.json
[2025-06-08T22:49:49.530+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:50.384+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for madrid
[2025-06-08T22:49:50.384+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kyiv
[2025-06-08T22:49:50.384+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kyiv/2025-06-06.json
[2025-06-08T22:49:50.386+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:50.388+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:50.815+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kyiv
[2025-06-08T22:49:50.816+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kyiv/2025-06-06.json
[2025-06-08T22:49:50.820+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:51.210+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kyiv
[2025-06-08T22:49:51.210+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rome
[2025-06-08T22:49:51.210+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rome/2025-06-06.json
[2025-06-08T22:49:51.211+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:51.215+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:51.654+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rome
[2025-06-08T22:49:51.654+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rome/2025-06-06.json
[2025-06-08T22:49:51.655+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:52.080+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rome
[2025-06-08T22:49:52.080+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: baku
[2025-06-08T22:49:52.080+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/baku/2025-06-06.json
[2025-06-08T22:49:52.082+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:52.084+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:52.468+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for baku
[2025-06-08T22:49:52.468+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/baku/2025-06-06.json
[2025-06-08T22:49:52.469+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:52.851+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for baku
[2025-06-08T22:49:52.851+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: paris
[2025-06-08T22:49:52.851+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/paris/2025-06-06.json
[2025-06-08T22:49:52.853+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:52.856+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:53.230+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for paris
[2025-06-08T22:49:53.231+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/paris/2025-06-06.json
[2025-06-08T22:49:53.234+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:53.634+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for paris
[2025-06-08T22:49:53.634+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: vienna
[2025-06-08T22:49:53.635+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/vienna/2025-06-06.json
[2025-06-08T22:49:53.636+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:53.639+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:54.022+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for vienna
[2025-06-08T22:49:54.022+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/vienna/2025-06-06.json
[2025-06-08T22:49:54.025+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:54.395+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for vienna
[2025-06-08T22:49:54.395+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: minsk
[2025-06-08T22:49:54.395+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/minsk/2025-06-06.json
[2025-06-08T22:49:54.397+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:54.400+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:54.780+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for minsk
[2025-06-08T22:49:54.781+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/minsk/2025-06-06.json
[2025-06-08T22:49:54.783+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:55.166+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for minsk
[2025-06-08T22:49:55.167+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: hamburg
[2025-06-08T22:49:55.167+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/hamburg/2025-06-06.json
[2025-06-08T22:49:55.168+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:55.171+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:55.579+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for hamburg
[2025-06-08T22:49:55.579+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/hamburg/2025-06-06.json
[2025-06-08T22:49:55.580+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:55.941+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for hamburg
[2025-06-08T22:49:55.941+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: warsaw
[2025-06-08T22:49:55.941+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/warsaw/2025-06-06.json
[2025-06-08T22:49:56.015+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:56.017+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:56.409+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for warsaw
[2025-06-08T22:49:56.409+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/warsaw/2025-06-06.json
[2025-06-08T22:49:56.410+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:56.767+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for warsaw
[2025-06-08T22:49:56.768+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: bucharest
[2025-06-08T22:49:56.768+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/bucharest/2025-06-06.json
[2025-06-08T22:49:56.769+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:56.772+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:57.159+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for bucharest
[2025-06-08T22:49:57.159+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/bucharest/2025-06-06.json
[2025-06-08T22:49:57.161+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:57.645+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for bucharest
[2025-06-08T22:49:57.646+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: barcelona
[2025-06-08T22:49:57.646+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/barcelona/2025-06-06.json
[2025-06-08T22:49:57.647+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:57.649+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:58.050+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for barcelona
[2025-06-08T22:49:58.050+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/barcelona/2025-06-06.json
[2025-06-08T22:49:58.052+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:58.460+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for barcelona
[2025-06-08T22:49:58.461+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: budapest
[2025-06-08T22:49:58.461+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/budapest/2025-06-06.json
[2025-06-08T22:49:58.463+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:58.465+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:58.850+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for budapest
[2025-06-08T22:49:58.850+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/budapest/2025-06-06.json
[2025-06-08T22:49:58.853+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:59.206+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for budapest
[2025-06-08T22:49:59.207+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: belgrade
[2025-06-08T22:49:59.207+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/belgrade/2025-06-06.json
[2025-06-08T22:49:59.208+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:59.210+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:49:59.579+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for belgrade
[2025-06-08T22:49:59.580+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/belgrade/2025-06-06.json
[2025-06-08T22:49:59.581+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:49:59.951+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for belgrade
[2025-06-08T22:49:59.951+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: munich
[2025-06-08T22:49:59.951+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/munich/2025-06-06.json
[2025-06-08T22:49:59.952+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:49:59.955+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:00.326+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for munich
[2025-06-08T22:50:00.327+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/munich/2025-06-06.json
[2025-06-08T22:50:00.328+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:00.695+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for munich
[2025-06-08T22:50:00.695+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kharkiv
[2025-06-08T22:50:00.695+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kharkiv/2025-06-06.json
[2025-06-08T22:50:00.696+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:00.699+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:01.077+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kharkiv
[2025-06-08T22:50:01.077+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kharkiv/2025-06-06.json
[2025-06-08T22:50:01.080+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:01.497+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kharkiv
[2025-06-08T22:50:01.497+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: prague
[2025-06-08T22:50:01.498+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/prague/2025-06-06.json
[2025-06-08T22:50:01.499+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:01.502+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:01.861+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for prague
[2025-06-08T22:50:01.862+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/prague/2025-06-06.json
[2025-06-08T22:50:01.864+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:02.291+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for prague
[2025-06-08T22:50:02.291+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: milan
[2025-06-08T22:50:02.291+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/milan/2025-06-06.json
[2025-06-08T22:50:02.293+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:02.295+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:02.673+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for milan
[2025-06-08T22:50:02.673+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/milan/2025-06-06.json
[2025-06-08T22:50:02.675+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:03.041+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for milan
[2025-06-08T22:50:03.042+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kazan
[2025-06-08T22:50:03.042+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kazan/2025-06-06.json
[2025-06-08T22:50:03.043+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:03.046+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:03.484+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kazan
[2025-06-08T22:50:03.484+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kazan/2025-06-06.json
[2025-06-08T22:50:03.487+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:03.968+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kazan
[2025-06-08T22:50:03.968+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: sofia
[2025-06-08T22:50:03.968+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/sofia/2025-06-06.json
[2025-06-08T22:50:03.969+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:03.972+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:04.391+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for sofia
[2025-06-08T22:50:04.391+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/sofia/2025-06-06.json
[2025-06-08T22:50:04.394+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:04.925+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for sofia
[2025-06-08T22:50:04.926+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: tbilisi
[2025-06-08T22:50:04.926+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/tbilisi/2025-06-06.json
[2025-06-08T22:50:04.927+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:04.929+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:05.360+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for tbilisi
[2025-06-08T22:50:05.360+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/tbilisi/2025-06-06.json
[2025-06-08T22:50:05.362+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:05.741+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for tbilisi
[2025-06-08T22:50:05.741+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: nizhny_novgorod
[2025-06-08T22:50:05.741+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/nizhny_novgorod/2025-06-06.json
[2025-06-08T22:50:05.744+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:05.746+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:06.126+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for nizhny_novgorod
[2025-06-08T22:50:06.126+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/nizhny_novgorod/2025-06-06.json
[2025-06-08T22:50:06.129+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:06.528+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for nizhny_novgorod
[2025-06-08T22:50:06.528+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: ufa
[2025-06-08T22:50:06.528+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/ufa/2025-06-06.json
[2025-06-08T22:50:06.530+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:06.533+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:06.899+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for ufa
[2025-06-08T22:50:06.899+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/ufa/2025-06-06.json
[2025-06-08T22:50:06.901+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:07.289+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for ufa
[2025-06-08T22:50:07.289+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: birmingham
[2025-06-08T22:50:07.290+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/birmingham/2025-06-06.json
[2025-06-08T22:50:07.291+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:07.294+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:07.654+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for birmingham
[2025-06-08T22:50:07.654+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/birmingham/2025-06-06.json
[2025-06-08T22:50:07.656+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:08.017+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for birmingham
[2025-06-08T22:50:08.017+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: krasnodar
[2025-06-08T22:50:08.018+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/krasnodar/2025-06-06.json
[2025-06-08T22:50:08.019+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:08.021+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:08.397+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for krasnodar
[2025-06-08T22:50:08.397+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/krasnodar/2025-06-06.json
[2025-06-08T22:50:08.399+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:08.783+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for krasnodar
[2025-06-08T22:50:08.783+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: samara
[2025-06-08T22:50:08.783+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/samara/2025-06-06.json
[2025-06-08T22:50:08.785+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:08.787+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:09.256+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for samara
[2025-06-08T22:50:09.257+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/samara/2025-06-06.json
[2025-06-08T22:50:09.263+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:10.073+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for samara
[2025-06-08T22:50:10.074+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rostov-on-don
[2025-06-08T22:50:10.074+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rostov-on-don/2025-06-06.json
[2025-06-08T22:50:10.076+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:10.081+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:10.947+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rostov-on-don
[2025-06-08T22:50:10.948+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rostov-on-don/2025-06-06.json
[2025-06-08T22:50:10.952+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:11.753+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rostov-on-don
[2025-06-08T22:50:11.753+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: yerevan
[2025-06-08T22:50:11.753+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/yerevan/2025-06-06.json
[2025-06-08T22:50:11.755+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:11.760+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:12.621+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for yerevan
[2025-06-08T22:50:12.622+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/yerevan/2025-06-06.json
[2025-06-08T22:50:12.625+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:13.317+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for yerevan
[2025-06-08T22:50:13.318+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: cologne
[2025-06-08T22:50:13.318+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/cologne/2025-06-06.json
[2025-06-08T22:50:13.320+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:13.326+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:13.961+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for cologne
[2025-06-08T22:50:13.962+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/cologne/2025-06-06.json
[2025-06-08T22:50:13.965+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:14.636+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for cologne
[2025-06-08T22:50:14.636+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: voronezh
[2025-06-08T22:50:14.636+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/voronezh/2025-06-06.json
[2025-06-08T22:50:14.639+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:14.649+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:15.419+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for voronezh
[2025-06-08T22:50:15.419+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/voronezh/2025-06-06.json
[2025-06-08T22:50:15.425+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:16.119+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for voronezh
[2025-06-08T22:50:16.120+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: perm
[2025-06-08T22:50:16.121+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/perm/2025-06-06.json
[2025-06-08T22:50:16.125+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:16.133+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:16.853+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for perm
[2025-06-08T22:50:16.853+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/perm/2025-06-06.json
[2025-06-08T22:50:16.858+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:17.513+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for perm
[2025-06-08T22:50:17.514+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: volgograd
[2025-06-08T22:50:17.515+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/volgograd/2025-06-06.json
[2025-06-08T22:50:17.517+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:17.523+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:18.161+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for volgograd
[2025-06-08T22:50:18.161+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/volgograd/2025-06-06.json
[2025-06-08T22:50:18.164+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:18.810+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for volgograd
[2025-06-08T22:50:18.811+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: odesa
[2025-06-08T22:50:18.811+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/odesa/2025-06-06.json
[2025-06-08T22:50:18.814+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:50:18.819+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:50:19.795+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for odesa
[2025-06-08T22:50:19.796+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/odesa/2025-06-06.json
[2025-06-08T22:50:19.800+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:50:20.735+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for odesa
[2025-06-08T22:50:21.719+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-08T22:50:21.719+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-08T22:50:21.719+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-08T22:50:21.723+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250606T000000, start_date=20250608T204937, end_date=20250608T205021
[2025-06-08T22:50:21.780+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-08T22:50:21.787+0200] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-06-08T22:50:21.788+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-06-08T22:58:29.318+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-08T22:58:29.331+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-08T22:58:29.334+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-08T22:58:29.334+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-08T22:58:29.350+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-06 00:00:00+00:00
[2025-06-08T22:58:29.353+0200] {standard_task_runner.py:63} INFO - Started process 1192613 to run task
[2025-06-08T22:58:29.356+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-06T00:00:00+00:00', '--job-id', '295', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmpnb1981js']
[2025-06-08T22:58:29.356+0200] {standard_task_runner.py:91} INFO - Job 295: Subtask format_daily_data_all_cities
[2025-06-08T22:58:29.386+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-08T22:58:29.436+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-06T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-06T00:00:00+00:00'
[2025-06-08T22:58:29.437+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-08T22:58:29.437+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-06
[2025-06-08T22:58:32.757+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-08T22:58:32.763+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 37 cities from config
[2025-06-08T22:58:32.763+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-08T22:58:32.763+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-06.json
[2025-06-08T22:58:32.769+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:32.774+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:35.498+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-08T22:58:35.498+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-06.json
[2025-06-08T22:58:35.502+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:36.037+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-08T22:58:36.038+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-08T22:58:36.038+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-06.json
[2025-06-08T22:58:36.040+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:36.043+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:36.512+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-08T22:58:36.513+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-06.json
[2025-06-08T22:58:36.514+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:36.986+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-08T22:58:36.986+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: london
[2025-06-08T22:58:36.986+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/london/2025-06-06.json
[2025-06-08T22:58:36.987+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:36.990+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:37.392+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for london
[2025-06-08T22:58:37.393+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/london/2025-06-06.json
[2025-06-08T22:58:37.395+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:37.771+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for london
[2025-06-08T22:58:37.771+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: saint_petersburg
[2025-06-08T22:58:37.772+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/saint_petersburg/2025-06-06.json
[2025-06-08T22:58:37.773+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:37.776+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:38.137+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for saint_petersburg
[2025-06-08T22:58:38.137+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/saint_petersburg/2025-06-06.json
[2025-06-08T22:58:38.139+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:38.506+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for saint_petersburg
[2025-06-08T22:58:38.506+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: berlin
[2025-06-08T22:58:38.506+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/berlin/2025-06-06.json
[2025-06-08T22:58:38.507+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:38.510+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:38.924+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for berlin
[2025-06-08T22:58:38.925+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/berlin/2025-06-06.json
[2025-06-08T22:58:38.927+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:39.283+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for berlin
[2025-06-08T22:58:39.283+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: madrid
[2025-06-08T22:58:39.284+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/madrid/2025-06-06.json
[2025-06-08T22:58:39.285+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:39.288+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:39.654+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for madrid
[2025-06-08T22:58:39.654+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/madrid/2025-06-06.json
[2025-06-08T22:58:39.657+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:40.059+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for madrid
[2025-06-08T22:58:40.059+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kyiv
[2025-06-08T22:58:40.059+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kyiv/2025-06-06.json
[2025-06-08T22:58:40.061+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:40.063+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:40.410+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kyiv
[2025-06-08T22:58:40.410+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kyiv/2025-06-06.json
[2025-06-08T22:58:40.412+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:40.800+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kyiv
[2025-06-08T22:58:40.800+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rome
[2025-06-08T22:58:40.800+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rome/2025-06-06.json
[2025-06-08T22:58:40.801+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:40.804+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:41.153+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rome
[2025-06-08T22:58:41.153+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rome/2025-06-06.json
[2025-06-08T22:58:41.155+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:41.552+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rome
[2025-06-08T22:58:41.552+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: baku
[2025-06-08T22:58:41.553+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/baku/2025-06-06.json
[2025-06-08T22:58:41.554+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:41.557+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:41.956+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for baku
[2025-06-08T22:58:41.957+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/baku/2025-06-06.json
[2025-06-08T22:58:41.959+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:42.367+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for baku
[2025-06-08T22:58:42.367+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: paris
[2025-06-08T22:58:42.367+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/paris/2025-06-06.json
[2025-06-08T22:58:42.368+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:42.370+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:42.750+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for paris
[2025-06-08T22:58:42.750+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/paris/2025-06-06.json
[2025-06-08T22:58:42.752+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:43.163+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for paris
[2025-06-08T22:58:43.164+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: vienna
[2025-06-08T22:58:43.164+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/vienna/2025-06-06.json
[2025-06-08T22:58:43.165+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:43.167+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:43.544+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for vienna
[2025-06-08T22:58:43.545+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/vienna/2025-06-06.json
[2025-06-08T22:58:43.547+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:43.918+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for vienna
[2025-06-08T22:58:43.919+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: minsk
[2025-06-08T22:58:43.919+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/minsk/2025-06-06.json
[2025-06-08T22:58:43.920+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:43.923+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:44.287+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for minsk
[2025-06-08T22:58:44.287+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/minsk/2025-06-06.json
[2025-06-08T22:58:44.289+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:44.653+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for minsk
[2025-06-08T22:58:44.653+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: hamburg
[2025-06-08T22:58:44.654+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/hamburg/2025-06-06.json
[2025-06-08T22:58:44.656+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:44.659+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:45.054+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for hamburg
[2025-06-08T22:58:45.055+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/hamburg/2025-06-06.json
[2025-06-08T22:58:45.057+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:45.440+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for hamburg
[2025-06-08T22:58:45.441+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: warsaw
[2025-06-08T22:58:45.441+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/warsaw/2025-06-06.json
[2025-06-08T22:58:45.509+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:45.511+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:45.853+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for warsaw
[2025-06-08T22:58:45.853+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/warsaw/2025-06-06.json
[2025-06-08T22:58:45.855+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:46.227+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for warsaw
[2025-06-08T22:58:46.228+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: bucharest
[2025-06-08T22:58:46.228+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/bucharest/2025-06-06.json
[2025-06-08T22:58:46.229+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:46.231+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:46.592+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for bucharest
[2025-06-08T22:58:46.593+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/bucharest/2025-06-06.json
[2025-06-08T22:58:46.594+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:46.945+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for bucharest
[2025-06-08T22:58:46.946+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: barcelona
[2025-06-08T22:58:46.946+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/barcelona/2025-06-06.json
[2025-06-08T22:58:46.947+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:46.950+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:47.314+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for barcelona
[2025-06-08T22:58:47.314+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/barcelona/2025-06-06.json
[2025-06-08T22:58:47.316+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:47.681+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for barcelona
[2025-06-08T22:58:47.681+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: budapest
[2025-06-08T22:58:47.682+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/budapest/2025-06-06.json
[2025-06-08T22:58:47.683+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:47.685+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:48.039+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for budapest
[2025-06-08T22:58:48.039+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/budapest/2025-06-06.json
[2025-06-08T22:58:48.041+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:48.374+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for budapest
[2025-06-08T22:58:48.374+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: belgrade
[2025-06-08T22:58:48.374+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/belgrade/2025-06-06.json
[2025-06-08T22:58:48.376+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:48.379+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:48.726+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for belgrade
[2025-06-08T22:58:48.726+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/belgrade/2025-06-06.json
[2025-06-08T22:58:48.728+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:49.070+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for belgrade
[2025-06-08T22:58:49.071+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: munich
[2025-06-08T22:58:49.071+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/munich/2025-06-06.json
[2025-06-08T22:58:49.073+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:49.076+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:49.435+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for munich
[2025-06-08T22:58:49.435+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/munich/2025-06-06.json
[2025-06-08T22:58:49.437+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:49.809+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for munich
[2025-06-08T22:58:49.810+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kharkiv
[2025-06-08T22:58:49.810+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kharkiv/2025-06-06.json
[2025-06-08T22:58:49.811+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:49.813+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:50.173+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kharkiv
[2025-06-08T22:58:50.173+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kharkiv/2025-06-06.json
[2025-06-08T22:58:50.175+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:50.513+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kharkiv
[2025-06-08T22:58:50.513+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: prague
[2025-06-08T22:58:50.513+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/prague/2025-06-06.json
[2025-06-08T22:58:50.514+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:50.517+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:50.870+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for prague
[2025-06-08T22:58:50.870+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/prague/2025-06-06.json
[2025-06-08T22:58:50.871+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:51.216+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for prague
[2025-06-08T22:58:51.217+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: milan
[2025-06-08T22:58:51.217+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/milan/2025-06-06.json
[2025-06-08T22:58:51.218+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:51.221+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:51.561+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for milan
[2025-06-08T22:58:51.562+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/milan/2025-06-06.json
[2025-06-08T22:58:51.564+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:51.924+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for milan
[2025-06-08T22:58:51.925+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kazan
[2025-06-08T22:58:51.925+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kazan/2025-06-06.json
[2025-06-08T22:58:51.926+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:51.928+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:52.321+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kazan
[2025-06-08T22:58:52.321+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kazan/2025-06-06.json
[2025-06-08T22:58:52.323+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:52.651+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kazan
[2025-06-08T22:58:52.651+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: sofia
[2025-06-08T22:58:52.651+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/sofia/2025-06-06.json
[2025-06-08T22:58:52.653+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:52.655+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:53.005+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for sofia
[2025-06-08T22:58:53.006+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/sofia/2025-06-06.json
[2025-06-08T22:58:53.009+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:53.364+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for sofia
[2025-06-08T22:58:53.365+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: tbilisi
[2025-06-08T22:58:53.365+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/tbilisi/2025-06-06.json
[2025-06-08T22:58:53.366+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:53.369+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:53.747+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for tbilisi
[2025-06-08T22:58:53.747+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/tbilisi/2025-06-06.json
[2025-06-08T22:58:53.748+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:54.110+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for tbilisi
[2025-06-08T22:58:54.110+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: nizhny_novgorod
[2025-06-08T22:58:54.110+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/nizhny_novgorod/2025-06-06.json
[2025-06-08T22:58:54.112+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:54.114+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:54.449+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for nizhny_novgorod
[2025-06-08T22:58:54.449+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/nizhny_novgorod/2025-06-06.json
[2025-06-08T22:58:54.451+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:54.792+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for nizhny_novgorod
[2025-06-08T22:58:54.793+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: ufa
[2025-06-08T22:58:54.793+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/ufa/2025-06-06.json
[2025-06-08T22:58:54.795+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:54.798+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:55.154+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for ufa
[2025-06-08T22:58:55.155+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/ufa/2025-06-06.json
[2025-06-08T22:58:55.156+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:55.508+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for ufa
[2025-06-08T22:58:55.508+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: birmingham
[2025-06-08T22:58:55.508+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/birmingham/2025-06-06.json
[2025-06-08T22:58:55.510+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:55.512+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:55.866+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for birmingham
[2025-06-08T22:58:55.866+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/birmingham/2025-06-06.json
[2025-06-08T22:58:55.868+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:56.238+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for birmingham
[2025-06-08T22:58:56.239+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: krasnodar
[2025-06-08T22:58:56.239+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/krasnodar/2025-06-06.json
[2025-06-08T22:58:56.240+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:56.243+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:56.602+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for krasnodar
[2025-06-08T22:58:56.602+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/krasnodar/2025-06-06.json
[2025-06-08T22:58:56.604+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:56.946+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for krasnodar
[2025-06-08T22:58:56.947+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: samara
[2025-06-08T22:58:56.947+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/samara/2025-06-06.json
[2025-06-08T22:58:56.948+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:56.950+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:57.308+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for samara
[2025-06-08T22:58:57.308+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/samara/2025-06-06.json
[2025-06-08T22:58:57.310+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:57.650+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for samara
[2025-06-08T22:58:57.650+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rostov-on-don
[2025-06-08T22:58:57.650+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rostov-on-don/2025-06-06.json
[2025-06-08T22:58:57.652+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:57.654+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:58.015+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rostov-on-don
[2025-06-08T22:58:58.015+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rostov-on-don/2025-06-06.json
[2025-06-08T22:58:58.017+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:58.390+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rostov-on-don
[2025-06-08T22:58:58.391+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: yerevan
[2025-06-08T22:58:58.391+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/yerevan/2025-06-06.json
[2025-06-08T22:58:58.392+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:58.394+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:58.728+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for yerevan
[2025-06-08T22:58:58.728+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/yerevan/2025-06-06.json
[2025-06-08T22:58:58.730+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:59.075+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for yerevan
[2025-06-08T22:58:59.075+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: cologne
[2025-06-08T22:58:59.075+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/cologne/2025-06-06.json
[2025-06-08T22:58:59.076+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:59.079+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:58:59.437+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for cologne
[2025-06-08T22:58:59.438+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/cologne/2025-06-06.json
[2025-06-08T22:58:59.441+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:58:59.794+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for cologne
[2025-06-08T22:58:59.794+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: voronezh
[2025-06-08T22:58:59.794+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/voronezh/2025-06-06.json
[2025-06-08T22:58:59.796+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:58:59.799+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:59:00.162+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for voronezh
[2025-06-08T22:59:00.163+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/voronezh/2025-06-06.json
[2025-06-08T22:59:00.166+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:59:00.556+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for voronezh
[2025-06-08T22:59:00.556+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: perm
[2025-06-08T22:59:00.557+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/perm/2025-06-06.json
[2025-06-08T22:59:00.558+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:59:00.560+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:59:00.926+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for perm
[2025-06-08T22:59:00.926+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/perm/2025-06-06.json
[2025-06-08T22:59:00.928+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:59:01.294+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for perm
[2025-06-08T22:59:01.294+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: volgograd
[2025-06-08T22:59:01.294+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/volgograd/2025-06-06.json
[2025-06-08T22:59:01.295+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:59:01.298+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:59:01.732+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for volgograd
[2025-06-08T22:59:01.732+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/volgograd/2025-06-06.json
[2025-06-08T22:59:01.735+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:59:02.133+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for volgograd
[2025-06-08T22:59:02.133+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: odesa
[2025-06-08T22:59:02.134+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/odesa/2025-06-06.json
[2025-06-08T22:59:02.135+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-08T22:59:02.137+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-08T22:59:02.577+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for odesa
[2025-06-08T22:59:02.577+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/odesa/2025-06-06.json
[2025-06-08T22:59:02.580+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-08T22:59:03.127+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for odesa
[2025-06-08T22:59:04.122+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-08T22:59:04.123+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-08T22:59:04.124+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-08T22:59:04.128+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250606T000000, start_date=20250608T205829, end_date=20250608T205904
[2025-06-08T22:59:04.196+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-08T22:59:04.221+0200] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-06-08T22:59:04.222+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-06-09T00:58:02.830+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-09T00:58:02.848+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-09T00:58:02.853+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-09T00:58:02.853+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-09T00:58:02.876+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-06 00:00:00+00:00
[2025-06-09T00:58:02.880+0200] {standard_task_runner.py:63} INFO - Started process 1300760 to run task
[2025-06-09T00:58:02.882+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-06T00:00:00+00:00', '--job-id', '340', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmpa6y636lk']
[2025-06-09T00:58:02.883+0200] {standard_task_runner.py:91} INFO - Job 340: Subtask format_daily_data_all_cities
[2025-06-09T00:58:02.926+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-09T00:58:03.004+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-06T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-06T00:00:00+00:00'
[2025-06-09T00:58:03.006+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-09T00:58:03.007+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-06
[2025-06-09T00:58:08.452+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-09T00:58:08.463+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 37 cities from config
[2025-06-09T00:58:08.463+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-09T00:58:08.464+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-06.json
[2025-06-09T00:58:08.468+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:08.476+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:13.634+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-09T00:58:13.635+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-06.json
[2025-06-09T00:58:13.643+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:14.976+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-09T00:58:14.976+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-09T00:58:14.977+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-06.json
[2025-06-09T00:58:14.981+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:14.995+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:16.079+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-09T00:58:16.079+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-06.json
[2025-06-09T00:58:16.084+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:17.199+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-09T00:58:17.200+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: london
[2025-06-09T00:58:17.201+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/london/2025-06-06.json
[2025-06-09T00:58:17.205+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:17.216+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:18.233+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for london
[2025-06-09T00:58:18.234+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/london/2025-06-06.json
[2025-06-09T00:58:18.239+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:19.075+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for london
[2025-06-09T00:58:19.075+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: saint_petersburg
[2025-06-09T00:58:19.075+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/saint_petersburg/2025-06-06.json
[2025-06-09T00:58:19.078+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:19.082+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:19.858+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for saint_petersburg
[2025-06-09T00:58:19.858+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/saint_petersburg/2025-06-06.json
[2025-06-09T00:58:19.863+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:20.754+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for saint_petersburg
[2025-06-09T00:58:20.754+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: berlin
[2025-06-09T00:58:20.754+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/berlin/2025-06-06.json
[2025-06-09T00:58:20.757+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:20.762+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:21.547+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for berlin
[2025-06-09T00:58:21.548+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/berlin/2025-06-06.json
[2025-06-09T00:58:21.551+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:22.364+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for berlin
[2025-06-09T00:58:22.365+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: madrid
[2025-06-09T00:58:22.365+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/madrid/2025-06-06.json
[2025-06-09T00:58:22.369+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:22.374+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:23.239+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for madrid
[2025-06-09T00:58:23.239+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/madrid/2025-06-06.json
[2025-06-09T00:58:23.246+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:24.018+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for madrid
[2025-06-09T00:58:24.019+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kyiv
[2025-06-09T00:58:24.019+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kyiv/2025-06-06.json
[2025-06-09T00:58:24.021+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:24.026+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:24.772+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kyiv
[2025-06-09T00:58:24.773+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kyiv/2025-06-06.json
[2025-06-09T00:58:24.776+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:25.760+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kyiv
[2025-06-09T00:58:25.761+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rome
[2025-06-09T00:58:25.761+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rome/2025-06-06.json
[2025-06-09T00:58:25.765+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:25.774+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:26.843+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rome
[2025-06-09T00:58:26.844+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rome/2025-06-06.json
[2025-06-09T00:58:26.849+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:27.606+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rome
[2025-06-09T00:58:27.607+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: baku
[2025-06-09T00:58:27.607+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/baku/2025-06-06.json
[2025-06-09T00:58:27.610+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:27.616+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:28.337+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for baku
[2025-06-09T00:58:28.337+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/baku/2025-06-06.json
[2025-06-09T00:58:28.340+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:29.270+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for baku
[2025-06-09T00:58:29.271+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: paris
[2025-06-09T00:58:29.271+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/paris/2025-06-06.json
[2025-06-09T00:58:29.275+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:29.286+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:30.143+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for paris
[2025-06-09T00:58:30.144+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/paris/2025-06-06.json
[2025-06-09T00:58:30.148+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:31.046+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for paris
[2025-06-09T00:58:31.046+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: vienna
[2025-06-09T00:58:31.046+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/vienna/2025-06-06.json
[2025-06-09T00:58:31.049+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:31.055+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:31.949+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for vienna
[2025-06-09T00:58:31.950+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/vienna/2025-06-06.json
[2025-06-09T00:58:31.954+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:32.717+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for vienna
[2025-06-09T00:58:32.717+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: minsk
[2025-06-09T00:58:32.718+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/minsk/2025-06-06.json
[2025-06-09T00:58:32.720+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:32.724+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:33.556+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for minsk
[2025-06-09T00:58:33.557+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/minsk/2025-06-06.json
[2025-06-09T00:58:33.565+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:34.278+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for minsk
[2025-06-09T00:58:34.279+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: hamburg
[2025-06-09T00:58:34.279+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/hamburg/2025-06-06.json
[2025-06-09T00:58:34.283+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:34.288+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:34.963+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for hamburg
[2025-06-09T00:58:34.963+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/hamburg/2025-06-06.json
[2025-06-09T00:58:34.967+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:36.107+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for hamburg
[2025-06-09T00:58:36.107+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: warsaw
[2025-06-09T00:58:36.108+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/warsaw/2025-06-06.json
[2025-06-09T00:58:36.112+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:36.119+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:37.171+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for warsaw
[2025-06-09T00:58:37.172+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/warsaw/2025-06-06.json
[2025-06-09T00:58:37.175+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:38.105+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for warsaw
[2025-06-09T00:58:38.106+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: bucharest
[2025-06-09T00:58:38.106+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/bucharest/2025-06-06.json
[2025-06-09T00:58:38.110+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:38.117+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:39.030+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for bucharest
[2025-06-09T00:58:39.030+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/bucharest/2025-06-06.json
[2025-06-09T00:58:39.034+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:40.063+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for bucharest
[2025-06-09T00:58:40.064+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: barcelona
[2025-06-09T00:58:40.064+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/barcelona/2025-06-06.json
[2025-06-09T00:58:40.067+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:40.073+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:41.070+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for barcelona
[2025-06-09T00:58:41.071+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/barcelona/2025-06-06.json
[2025-06-09T00:58:41.076+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:42.224+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for barcelona
[2025-06-09T00:58:42.224+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: budapest
[2025-06-09T00:58:42.224+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/budapest/2025-06-06.json
[2025-06-09T00:58:42.227+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:42.233+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:42.898+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for budapest
[2025-06-09T00:58:42.899+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/budapest/2025-06-06.json
[2025-06-09T00:58:42.903+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:43.720+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for budapest
[2025-06-09T00:58:43.721+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: belgrade
[2025-06-09T00:58:43.721+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/belgrade/2025-06-06.json
[2025-06-09T00:58:43.724+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:43.730+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:44.846+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for belgrade
[2025-06-09T00:58:44.847+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/belgrade/2025-06-06.json
[2025-06-09T00:58:44.850+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:45.740+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for belgrade
[2025-06-09T00:58:45.740+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: munich
[2025-06-09T00:58:45.741+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/munich/2025-06-06.json
[2025-06-09T00:58:45.743+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:45.749+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:46.520+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for munich
[2025-06-09T00:58:46.521+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/munich/2025-06-06.json
[2025-06-09T00:58:46.526+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:47.256+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for munich
[2025-06-09T00:58:47.258+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kharkiv
[2025-06-09T00:58:47.258+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kharkiv/2025-06-06.json
[2025-06-09T00:58:47.260+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:47.266+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:47.964+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kharkiv
[2025-06-09T00:58:47.965+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kharkiv/2025-06-06.json
[2025-06-09T00:58:47.969+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:48.636+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kharkiv
[2025-06-09T00:58:48.637+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: prague
[2025-06-09T00:58:48.637+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/prague/2025-06-06.json
[2025-06-09T00:58:48.641+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:48.647+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:49.317+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for prague
[2025-06-09T00:58:49.318+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/prague/2025-06-06.json
[2025-06-09T00:58:49.321+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:50.035+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for prague
[2025-06-09T00:58:50.036+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: milan
[2025-06-09T00:58:50.036+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/milan/2025-06-06.json
[2025-06-09T00:58:50.039+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:50.043+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:50.773+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for milan
[2025-06-09T00:58:50.774+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/milan/2025-06-06.json
[2025-06-09T00:58:50.778+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:51.481+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for milan
[2025-06-09T00:58:51.481+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kazan
[2025-06-09T00:58:51.482+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kazan/2025-06-06.json
[2025-06-09T00:58:51.485+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:51.490+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:52.213+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kazan
[2025-06-09T00:58:52.213+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kazan/2025-06-06.json
[2025-06-09T00:58:52.216+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:52.859+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kazan
[2025-06-09T00:58:52.859+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: sofia
[2025-06-09T00:58:52.860+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/sofia/2025-06-06.json
[2025-06-09T00:58:52.862+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:52.869+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:53.607+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for sofia
[2025-06-09T00:58:53.607+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/sofia/2025-06-06.json
[2025-06-09T00:58:53.610+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:54.372+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for sofia
[2025-06-09T00:58:54.372+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: tbilisi
[2025-06-09T00:58:54.372+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/tbilisi/2025-06-06.json
[2025-06-09T00:58:54.375+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:54.381+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:55.215+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for tbilisi
[2025-06-09T00:58:55.215+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/tbilisi/2025-06-06.json
[2025-06-09T00:58:55.219+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:56.087+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for tbilisi
[2025-06-09T00:58:56.089+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: nizhny_novgorod
[2025-06-09T00:58:56.090+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/nizhny_novgorod/2025-06-06.json
[2025-06-09T00:58:56.093+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:56.105+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:57.423+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for nizhny_novgorod
[2025-06-09T00:58:57.423+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/nizhny_novgorod/2025-06-06.json
[2025-06-09T00:58:57.427+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:58.176+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for nizhny_novgorod
[2025-06-09T00:58:58.176+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: ufa
[2025-06-09T00:58:58.177+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/ufa/2025-06-06.json
[2025-06-09T00:58:58.179+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:58.187+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:58:59.000+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for ufa
[2025-06-09T00:58:59.001+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/ufa/2025-06-06.json
[2025-06-09T00:58:59.004+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:58:59.710+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for ufa
[2025-06-09T00:58:59.710+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: birmingham
[2025-06-09T00:58:59.711+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/birmingham/2025-06-06.json
[2025-06-09T00:58:59.713+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:58:59.719+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:00.487+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for birmingham
[2025-06-09T00:59:00.488+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/birmingham/2025-06-06.json
[2025-06-09T00:59:00.492+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:01.146+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for birmingham
[2025-06-09T00:59:01.146+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: krasnodar
[2025-06-09T00:59:01.147+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/krasnodar/2025-06-06.json
[2025-06-09T00:59:01.149+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:01.154+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:01.821+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for krasnodar
[2025-06-09T00:59:01.821+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/krasnodar/2025-06-06.json
[2025-06-09T00:59:01.824+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:02.502+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for krasnodar
[2025-06-09T00:59:02.502+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: samara
[2025-06-09T00:59:02.503+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/samara/2025-06-06.json
[2025-06-09T00:59:02.505+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:02.509+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:03.408+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for samara
[2025-06-09T00:59:03.408+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/samara/2025-06-06.json
[2025-06-09T00:59:03.412+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:04.291+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for samara
[2025-06-09T00:59:04.292+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rostov-on-don
[2025-06-09T00:59:04.293+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rostov-on-don/2025-06-06.json
[2025-06-09T00:59:04.296+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:04.302+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:05.090+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rostov-on-don
[2025-06-09T00:59:05.090+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rostov-on-don/2025-06-06.json
[2025-06-09T00:59:05.094+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:05.796+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rostov-on-don
[2025-06-09T00:59:05.798+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: yerevan
[2025-06-09T00:59:05.798+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/yerevan/2025-06-06.json
[2025-06-09T00:59:05.801+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:05.807+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:06.587+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for yerevan
[2025-06-09T00:59:06.587+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/yerevan/2025-06-06.json
[2025-06-09T00:59:06.591+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:07.427+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for yerevan
[2025-06-09T00:59:07.428+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: cologne
[2025-06-09T00:59:07.428+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/cologne/2025-06-06.json
[2025-06-09T00:59:07.431+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:07.436+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:08.135+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for cologne
[2025-06-09T00:59:08.135+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/cologne/2025-06-06.json
[2025-06-09T00:59:08.138+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:08.839+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for cologne
[2025-06-09T00:59:08.839+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: voronezh
[2025-06-09T00:59:08.840+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/voronezh/2025-06-06.json
[2025-06-09T00:59:08.843+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:08.849+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:09.503+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for voronezh
[2025-06-09T00:59:09.503+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/voronezh/2025-06-06.json
[2025-06-09T00:59:09.508+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:10.224+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for voronezh
[2025-06-09T00:59:10.225+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: perm
[2025-06-09T00:59:10.225+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/perm/2025-06-06.json
[2025-06-09T00:59:10.227+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:10.231+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:10.997+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for perm
[2025-06-09T00:59:10.997+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/perm/2025-06-06.json
[2025-06-09T00:59:11.001+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:12.049+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for perm
[2025-06-09T00:59:12.049+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: volgograd
[2025-06-09T00:59:12.049+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/volgograd/2025-06-06.json
[2025-06-09T00:59:12.052+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:12.057+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:12.880+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for volgograd
[2025-06-09T00:59:12.881+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/volgograd/2025-06-06.json
[2025-06-09T00:59:12.884+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:13.531+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for volgograd
[2025-06-09T00:59:13.532+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: odesa
[2025-06-09T00:59:13.533+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/odesa/2025-06-06.json
[2025-06-09T00:59:13.535+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:59:13.546+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:59:14.326+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for odesa
[2025-06-09T00:59:14.327+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/odesa/2025-06-06.json
[2025-06-09T00:59:14.330+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:59:14.956+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for odesa
[2025-06-09T00:59:15.937+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-09T00:59:15.937+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-09T00:59:15.937+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-09T00:59:15.940+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250606T000000, start_date=20250608T225802, end_date=20250608T225915
[2025-06-09T00:59:15.974+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-09T00:59:15.984+0200] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-06-09T00:59:15.984+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-06-09T12:04:18.101+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-09T12:04:18.112+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-09T12:04:18.115+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-09T12:04:18.115+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-09T12:04:18.132+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-06 00:00:00+00:00
[2025-06-09T12:04:18.134+0200] {standard_task_runner.py:63} INFO - Started process 22596 to run task
[2025-06-09T12:04:18.137+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-06T00:00:00+00:00', '--job-id', '361', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmp12mzg25t']
[2025-06-09T12:04:18.138+0200] {standard_task_runner.py:91} INFO - Job 361: Subtask format_daily_data_all_cities
[2025-06-09T12:04:18.169+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-09T12:04:18.221+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-06T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-06T00:00:00+00:00'
[2025-06-09T12:04:18.222+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-09T12:04:18.223+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-06
[2025-06-09T12:04:21.559+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-09T12:04:21.565+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 2 cities from config
[2025-06-09T12:04:21.565+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-09T12:04:21.566+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-06.json
[2025-06-09T12:04:21.568+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T12:04:21.574+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T12:04:24.156+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-09T12:04:24.156+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-06.json
[2025-06-09T12:04:24.158+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T12:04:24.695+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-09T12:04:24.696+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-09T12:04:24.696+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-06.json
[2025-06-09T12:04:24.697+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T12:04:24.699+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T12:04:25.175+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-09T12:04:25.175+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-06.json
[2025-06-09T12:04:25.178+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T12:04:25.615+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-09T12:04:26.608+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-09T12:04:26.609+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-09T12:04:26.609+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-09T12:04:26.613+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250606T000000, start_date=20250609T100418, end_date=20250609T100426
[2025-06-09T12:04:26.647+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-09T12:04:26.655+0200] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T12:04:26.664+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-06-09T15:28:42.928+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-09T15:28:42.941+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-09T15:28:42.944+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [queued]>
[2025-06-09T15:28:42.944+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-09T15:28:42.960+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-06 00:00:00+00:00
[2025-06-09T15:28:42.962+0200] {standard_task_runner.py:63} INFO - Started process 78330 to run task
[2025-06-09T15:28:42.965+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-06T00:00:00+00:00', '--job-id', '384', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmpemw2ql49']
[2025-06-09T15:28:42.965+0200] {standard_task_runner.py:91} INFO - Job 384: Subtask format_daily_data_all_cities
[2025-06-09T15:28:42.993+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-06T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-09T15:28:43.045+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-06T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-06T00:00:00+00:00'
[2025-06-09T15:28:43.046+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-09T15:28:43.047+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-06
[2025-06-09T15:28:46.567+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-09T15:28:46.575+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 2 cities from config
[2025-06-09T15:28:46.575+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-09T15:28:46.575+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-06.json
[2025-06-09T15:28:46.578+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T15:28:46.582+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T15:28:51.198+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-09T15:28:51.199+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-06.json
[2025-06-09T15:28:51.201+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T15:28:51.862+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-09T15:28:51.862+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-09T15:28:51.862+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-06.json
[2025-06-09T15:28:51.864+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T15:28:51.867+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T15:28:52.429+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-09T15:28:52.429+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-06.json
[2025-06-09T15:28:52.431+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T15:28:52.973+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-09T15:28:53.965+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-09T15:28:53.965+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-09T15:28:53.965+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-09T15:28:53.968+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250606T000000, start_date=20250609T132842, end_date=20250609T132853
[2025-06-09T15:28:54.013+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-09T15:28:54.024+0200] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T15:28:54.035+0200] {local_task_job_runner.py:222} INFO - ::endgroup::

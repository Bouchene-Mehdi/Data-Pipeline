[2025-06-09T00:53:55.020+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-09T00:53:55.033+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [queued]>
[2025-06-09T00:53:55.036+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [queued]>
[2025-06-09T00:53:55.036+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-09T00:53:55.060+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-05 00:00:00+00:00
[2025-06-09T00:53:55.063+0200] {standard_task_runner.py:63} INFO - Started process 1296350 to run task
[2025-06-09T00:53:55.065+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-05T00:00:00+00:00', '--job-id', '338', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmpfstijnlk']
[2025-06-09T00:53:55.065+0200] {standard_task_runner.py:91} INFO - Job 338: Subtask format_daily_data_all_cities
[2025-06-09T00:53:55.099+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-09T00:53:55.162+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-05T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-05T00:00:00+00:00'
[2025-06-09T00:53:55.163+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-09T00:53:55.164+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-05
[2025-06-09T00:53:59.584+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-09T00:53:59.592+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 37 cities from config
[2025-06-09T00:53:59.592+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-09T00:53:59.592+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-05.json
[2025-06-09T00:53:59.597+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:53:59.603+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:04.415+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-09T00:54:04.415+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-05.json
[2025-06-09T00:54:04.419+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:06.123+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-09T00:54:06.123+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-09T00:54:06.124+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-05.json
[2025-06-09T00:54:06.133+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:06.152+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:08.925+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-09T00:54:08.926+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-05.json
[2025-06-09T00:54:08.935+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:11.735+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-09T00:54:11.735+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: london
[2025-06-09T00:54:11.739+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/london/2025-06-05.json
[2025-06-09T00:54:11.744+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:11.763+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:13.052+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for london
[2025-06-09T00:54:13.052+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/london/2025-06-05.json
[2025-06-09T00:54:13.058+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:14.095+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for london
[2025-06-09T00:54:14.095+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: saint_petersburg
[2025-06-09T00:54:14.095+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/saint_petersburg/2025-06-05.json
[2025-06-09T00:54:14.097+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:14.104+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:15.151+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for saint_petersburg
[2025-06-09T00:54:15.152+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/saint_petersburg/2025-06-05.json
[2025-06-09T00:54:15.157+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:16.091+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for saint_petersburg
[2025-06-09T00:54:16.091+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: berlin
[2025-06-09T00:54:16.092+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/berlin/2025-06-05.json
[2025-06-09T00:54:16.095+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:16.101+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:17.000+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for berlin
[2025-06-09T00:54:17.001+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/berlin/2025-06-05.json
[2025-06-09T00:54:17.005+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:17.873+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for berlin
[2025-06-09T00:54:17.873+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: madrid
[2025-06-09T00:54:17.874+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/madrid/2025-06-05.json
[2025-06-09T00:54:17.875+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:17.880+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:18.750+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for madrid
[2025-06-09T00:54:18.751+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/madrid/2025-06-05.json
[2025-06-09T00:54:18.755+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:19.692+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for madrid
[2025-06-09T00:54:19.693+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kyiv
[2025-06-09T00:54:19.693+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kyiv/2025-06-05.json
[2025-06-09T00:54:19.696+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:19.712+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:20.911+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kyiv
[2025-06-09T00:54:20.912+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kyiv/2025-06-05.json
[2025-06-09T00:54:20.915+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:21.818+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kyiv
[2025-06-09T00:54:21.818+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rome
[2025-06-09T00:54:21.819+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rome/2025-06-05.json
[2025-06-09T00:54:21.823+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:21.830+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:22.724+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rome
[2025-06-09T00:54:22.725+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rome/2025-06-05.json
[2025-06-09T00:54:22.729+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:23.688+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rome
[2025-06-09T00:54:23.689+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: baku
[2025-06-09T00:54:23.689+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/baku/2025-06-05.json
[2025-06-09T00:54:23.691+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:23.696+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:24.553+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for baku
[2025-06-09T00:54:24.553+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/baku/2025-06-05.json
[2025-06-09T00:54:24.556+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:25.454+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for baku
[2025-06-09T00:54:25.454+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: paris
[2025-06-09T00:54:25.455+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/paris/2025-06-05.json
[2025-06-09T00:54:25.458+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:25.463+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:26.246+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for paris
[2025-06-09T00:54:26.247+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/paris/2025-06-05.json
[2025-06-09T00:54:26.250+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:27.038+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for paris
[2025-06-09T00:54:27.038+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: vienna
[2025-06-09T00:54:27.039+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/vienna/2025-06-05.json
[2025-06-09T00:54:27.041+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:27.048+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:27.809+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for vienna
[2025-06-09T00:54:27.809+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/vienna/2025-06-05.json
[2025-06-09T00:54:27.813+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:28.679+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for vienna
[2025-06-09T00:54:28.680+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: minsk
[2025-06-09T00:54:28.680+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/minsk/2025-06-05.json
[2025-06-09T00:54:28.682+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:28.687+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:29.422+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for minsk
[2025-06-09T00:54:29.422+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/minsk/2025-06-05.json
[2025-06-09T00:54:29.427+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:30.155+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for minsk
[2025-06-09T00:54:30.156+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: hamburg
[2025-06-09T00:54:30.156+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/hamburg/2025-06-05.json
[2025-06-09T00:54:30.160+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:30.165+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:31.040+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for hamburg
[2025-06-09T00:54:31.041+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/hamburg/2025-06-05.json
[2025-06-09T00:54:31.043+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:31.783+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for hamburg
[2025-06-09T00:54:31.784+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: warsaw
[2025-06-09T00:54:31.785+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/warsaw/2025-06-05.json
[2025-06-09T00:54:31.926+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:31.931+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:32.706+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for warsaw
[2025-06-09T00:54:32.706+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/warsaw/2025-06-05.json
[2025-06-09T00:54:32.710+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:33.532+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for warsaw
[2025-06-09T00:54:33.533+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: bucharest
[2025-06-09T00:54:33.533+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/bucharest/2025-06-05.json
[2025-06-09T00:54:33.535+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:33.542+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:34.326+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for bucharest
[2025-06-09T00:54:34.326+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/bucharest/2025-06-05.json
[2025-06-09T00:54:34.330+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:35.249+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for bucharest
[2025-06-09T00:54:35.249+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: barcelona
[2025-06-09T00:54:35.250+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/barcelona/2025-06-05.json
[2025-06-09T00:54:35.252+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:35.256+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:36.288+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for barcelona
[2025-06-09T00:54:36.289+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/barcelona/2025-06-05.json
[2025-06-09T00:54:36.293+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:37.035+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for barcelona
[2025-06-09T00:54:37.036+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: budapest
[2025-06-09T00:54:37.037+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/budapest/2025-06-05.json
[2025-06-09T00:54:37.038+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:37.044+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:37.777+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for budapest
[2025-06-09T00:54:37.778+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/budapest/2025-06-05.json
[2025-06-09T00:54:37.781+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:38.467+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for budapest
[2025-06-09T00:54:38.468+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: belgrade
[2025-06-09T00:54:38.468+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/belgrade/2025-06-05.json
[2025-06-09T00:54:38.470+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:38.474+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:39.208+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for belgrade
[2025-06-09T00:54:39.209+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/belgrade/2025-06-05.json
[2025-06-09T00:54:39.212+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:39.937+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for belgrade
[2025-06-09T00:54:39.938+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: munich
[2025-06-09T00:54:39.938+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/munich/2025-06-05.json
[2025-06-09T00:54:39.940+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:39.945+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:40.700+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for munich
[2025-06-09T00:54:40.701+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/munich/2025-06-05.json
[2025-06-09T00:54:40.705+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:41.437+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for munich
[2025-06-09T00:54:41.438+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kharkiv
[2025-06-09T00:54:41.438+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kharkiv/2025-06-05.json
[2025-06-09T00:54:41.441+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:41.447+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:42.090+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kharkiv
[2025-06-09T00:54:42.091+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kharkiv/2025-06-05.json
[2025-06-09T00:54:42.094+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:42.736+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kharkiv
[2025-06-09T00:54:42.737+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: prague
[2025-06-09T00:54:42.737+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/prague/2025-06-05.json
[2025-06-09T00:54:42.739+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:42.744+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:43.414+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for prague
[2025-06-09T00:54:43.415+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/prague/2025-06-05.json
[2025-06-09T00:54:43.417+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:44.042+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for prague
[2025-06-09T00:54:44.043+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: milan
[2025-06-09T00:54:44.043+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/milan/2025-06-05.json
[2025-06-09T00:54:44.045+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:44.051+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:44.827+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for milan
[2025-06-09T00:54:44.828+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/milan/2025-06-05.json
[2025-06-09T00:54:44.831+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:45.758+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for milan
[2025-06-09T00:54:45.759+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: kazan
[2025-06-09T00:54:45.759+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/kazan/2025-06-05.json
[2025-06-09T00:54:45.762+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:45.768+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:46.681+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for kazan
[2025-06-09T00:54:46.682+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/kazan/2025-06-05.json
[2025-06-09T00:54:46.689+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:47.545+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for kazan
[2025-06-09T00:54:47.545+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: sofia
[2025-06-09T00:54:47.545+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/sofia/2025-06-05.json
[2025-06-09T00:54:47.547+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:47.552+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:48.433+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for sofia
[2025-06-09T00:54:48.433+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/sofia/2025-06-05.json
[2025-06-09T00:54:48.437+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:49.203+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for sofia
[2025-06-09T00:54:49.203+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: tbilisi
[2025-06-09T00:54:49.203+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/tbilisi/2025-06-05.json
[2025-06-09T00:54:49.205+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:49.209+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:49.968+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for tbilisi
[2025-06-09T00:54:49.968+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/tbilisi/2025-06-05.json
[2025-06-09T00:54:49.973+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:50.900+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for tbilisi
[2025-06-09T00:54:50.901+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: nizhny_novgorod
[2025-06-09T00:54:50.901+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/nizhny_novgorod/2025-06-05.json
[2025-06-09T00:54:50.904+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:50.910+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:52.021+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for nizhny_novgorod
[2025-06-09T00:54:52.022+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/nizhny_novgorod/2025-06-05.json
[2025-06-09T00:54:52.025+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:52.709+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for nizhny_novgorod
[2025-06-09T00:54:52.709+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: ufa
[2025-06-09T00:54:52.709+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/ufa/2025-06-05.json
[2025-06-09T00:54:52.711+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:52.716+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:53.589+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for ufa
[2025-06-09T00:54:53.590+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/ufa/2025-06-05.json
[2025-06-09T00:54:53.594+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:54.439+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for ufa
[2025-06-09T00:54:54.440+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: birmingham
[2025-06-09T00:54:54.440+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/birmingham/2025-06-05.json
[2025-06-09T00:54:54.443+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:54.448+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:55.273+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for birmingham
[2025-06-09T00:54:55.274+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/birmingham/2025-06-05.json
[2025-06-09T00:54:55.279+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:56.188+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for birmingham
[2025-06-09T00:54:56.189+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: krasnodar
[2025-06-09T00:54:56.190+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/krasnodar/2025-06-05.json
[2025-06-09T00:54:56.193+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:56.201+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:57.130+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for krasnodar
[2025-06-09T00:54:57.131+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/krasnodar/2025-06-05.json
[2025-06-09T00:54:57.138+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:58.084+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for krasnodar
[2025-06-09T00:54:58.085+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: samara
[2025-06-09T00:54:58.085+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/samara/2025-06-05.json
[2025-06-09T00:54:58.087+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:58.094+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:54:58.957+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for samara
[2025-06-09T00:54:58.958+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/samara/2025-06-05.json
[2025-06-09T00:54:58.961+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:54:59.936+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for samara
[2025-06-09T00:54:59.936+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: rostov-on-don
[2025-06-09T00:54:59.937+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/rostov-on-don/2025-06-05.json
[2025-06-09T00:54:59.939+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:54:59.947+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:00.918+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for rostov-on-don
[2025-06-09T00:55:00.919+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/rostov-on-don/2025-06-05.json
[2025-06-09T00:55:00.923+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:01.813+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for rostov-on-don
[2025-06-09T00:55:01.814+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: yerevan
[2025-06-09T00:55:01.814+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/yerevan/2025-06-05.json
[2025-06-09T00:55:01.818+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:55:01.831+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:02.784+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for yerevan
[2025-06-09T00:55:02.784+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/yerevan/2025-06-05.json
[2025-06-09T00:55:02.788+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:03.542+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for yerevan
[2025-06-09T00:55:03.542+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: cologne
[2025-06-09T00:55:03.543+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/cologne/2025-06-05.json
[2025-06-09T00:55:03.546+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:55:03.552+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:04.481+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for cologne
[2025-06-09T00:55:04.482+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/cologne/2025-06-05.json
[2025-06-09T00:55:04.485+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:05.280+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for cologne
[2025-06-09T00:55:05.280+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: voronezh
[2025-06-09T00:55:05.281+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/voronezh/2025-06-05.json
[2025-06-09T00:55:05.288+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:55:05.301+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:06.327+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for voronezh
[2025-06-09T00:55:06.328+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/voronezh/2025-06-05.json
[2025-06-09T00:55:06.332+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:07.356+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for voronezh
[2025-06-09T00:55:07.358+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: perm
[2025-06-09T00:55:07.359+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/perm/2025-06-05.json
[2025-06-09T00:55:07.361+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:55:07.368+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:08.301+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for perm
[2025-06-09T00:55:08.301+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/perm/2025-06-05.json
[2025-06-09T00:55:08.306+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:09.436+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for perm
[2025-06-09T00:55:09.437+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: volgograd
[2025-06-09T00:55:09.437+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/volgograd/2025-06-05.json
[2025-06-09T00:55:09.440+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:55:09.447+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:10.378+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for volgograd
[2025-06-09T00:55:10.379+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/volgograd/2025-06-05.json
[2025-06-09T00:55:10.383+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:11.220+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for volgograd
[2025-06-09T00:55:11.220+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: odesa
[2025-06-09T00:55:11.221+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/odesa/2025-06-05.json
[2025-06-09T00:55:11.223+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T00:55:11.228+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T00:55:12.132+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for odesa
[2025-06-09T00:55:12.133+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/odesa/2025-06-05.json
[2025-06-09T00:55:12.137+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T00:55:12.940+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for odesa
[2025-06-09T00:55:13.929+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-09T00:55:13.929+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-09T00:55:13.929+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-09T00:55:13.933+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250605T000000, start_date=20250608T225355, end_date=20250608T225513
[2025-06-09T00:55:13.977+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-09T00:55:13.984+0200] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-06-09T00:55:13.984+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-06-09T12:03:44.210+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-09T12:03:44.226+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [queued]>
[2025-06-09T12:03:44.230+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [queued]>
[2025-06-09T12:03:44.230+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-09T12:03:44.246+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-05 00:00:00+00:00
[2025-06-09T12:03:44.249+0200] {standard_task_runner.py:63} INFO - Started process 21762 to run task
[2025-06-09T12:03:44.251+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-05T00:00:00+00:00', '--job-id', '358', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmp6yg3x9fk']
[2025-06-09T12:03:44.252+0200] {standard_task_runner.py:91} INFO - Job 358: Subtask format_daily_data_all_cities
[2025-06-09T12:03:44.285+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-09T12:03:44.340+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-05T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-05T00:00:00+00:00'
[2025-06-09T12:03:44.341+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-09T12:03:44.342+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-05
[2025-06-09T12:03:48.490+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-09T12:03:48.499+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 2 cities from config
[2025-06-09T12:03:48.499+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-09T12:03:48.499+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-05.json
[2025-06-09T12:03:48.503+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T12:03:48.510+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T12:03:51.110+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-09T12:03:51.111+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-05.json
[2025-06-09T12:03:51.114+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T12:03:51.605+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-09T12:03:51.606+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-09T12:03:51.606+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-05.json
[2025-06-09T12:03:51.607+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T12:03:51.610+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T12:03:52.065+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-09T12:03:52.065+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-05.json
[2025-06-09T12:03:52.068+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T12:03:52.555+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-09T12:03:53.551+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-09T12:03:53.552+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-09T12:03:53.552+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-09T12:03:53.557+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250605T000000, start_date=20250609T100344, end_date=20250609T100353
[2025-06-09T12:03:53.600+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-09T12:03:53.607+0200] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T12:03:53.617+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-06-09T15:27:50.163+0200] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-06-09T15:27:50.188+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [queued]>
[2025-06-09T15:27:50.193+0200] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [queued]>
[2025-06-09T15:27:50.193+0200] {taskinstance.py:2303} INFO - Starting attempt 1 of 2
[2025-06-09T15:27:50.214+0200] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): format_daily_data_all_cities> on 2025-06-05 00:00:00+00:00
[2025-06-09T15:27:50.216+0200] {standard_task_runner.py:63} INFO - Started process 77181 to run task
[2025-06-09T15:27:50.220+0200] {standard_task_runner.py:90} INFO - Running: ['airflow', 'tasks', 'run', 'fetch_daily_pollution_weather_dag', 'format_daily_data_all_cities', 'scheduled__2025-06-05T00:00:00+00:00', '--job-id', '380', '--raw', '--subdir', 'DAGS_FOLDER/daily_dag.py', '--cfg-path', '/tmp/tmpilephzr6']
[2025-06-09T15:27:50.221+0200] {standard_task_runner.py:91} INFO - Job 380: Subtask format_daily_data_all_cities
[2025-06-09T15:27:50.275+0200] {task_command.py:426} INFO - Running <TaskInstance: fetch_daily_pollution_weather_dag.format_daily_data_all_cities scheduled__2025-06-05T00:00:00+00:00 [running]> on host DESKTOP-2QS8J6D.
[2025-06-09T15:27:50.351+0200] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='fetch_daily_pollution_weather_dag' AIRFLOW_CTX_TASK_ID='format_daily_data_all_cities' AIRFLOW_CTX_EXECUTION_DATE='2025-06-05T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-06-05T00:00:00+00:00'
[2025-06-09T15:27:50.352+0200] {taskinstance.py:430} INFO - ::endgroup::
[2025-06-09T15:27:50.353+0200] {logging_mixin.py:188} INFO - [START] Formatting data for execution_date: 2025-06-05
[2025-06-09T15:27:54.725+0200] {logging_mixin.py:188} INFO - [INFO] Spark session started
[2025-06-09T15:27:54.736+0200] {logging_mixin.py:188} INFO - [INFO] Loaded 2 cities from config
[2025-06-09T15:27:54.736+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: istanbul
[2025-06-09T15:27:54.737+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/istanbul/2025-06-05.json
[2025-06-09T15:27:54.743+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T15:27:54.748+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T15:27:58.149+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for istanbul
[2025-06-09T15:27:58.150+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/istanbul/2025-06-05.json
[2025-06-09T15:27:58.153+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T15:27:58.820+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for istanbul
[2025-06-09T15:27:58.820+0200] {logging_mixin.py:188} INFO - [PROCESSING] City: moscow
[2025-06-09T15:27:58.820+0200] {logging_mixin.py:188} INFO - [FOUND] Pollution file exists: /home/ccd/airflow/data/raw/pollution/moscow/2025-06-05.json
[2025-06-09T15:27:58.822+0200] {logging_mixin.py:188} INFO - [INFO] Flattened pollution data: 25 rows
[2025-06-09T15:27:58.825+0200] {logging_mixin.py:188} INFO - [INFO] Aggregated pollution data: 1 rows
[2025-06-09T15:27:59.352+0200] {logging_mixin.py:188} INFO - [OK] Formatted pollution for moscow
[2025-06-09T15:27:59.352+0200] {logging_mixin.py:188} INFO - [FOUND] Weather file exists: /home/ccd/airflow/data/raw/weather/moscow/2025-06-05.json
[2025-06-09T15:27:59.354+0200] {logging_mixin.py:188} INFO - [INFO] Flattened weather data: 1 rows
[2025-06-09T15:27:59.857+0200] {logging_mixin.py:188} INFO - [OK] Formatted weather for moscow
[2025-06-09T15:28:00.847+0200] {logging_mixin.py:188} INFO - [DONE] Spark session closed
[2025-06-09T15:28:00.847+0200] {python.py:237} INFO - Done. Returned value was: None
[2025-06-09T15:28:00.847+0200] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-06-09T15:28:00.850+0200] {taskinstance.py:1205} INFO - Marking task as SUCCESS. dag_id=fetch_daily_pollution_weather_dag, task_id=format_daily_data_all_cities, execution_date=20250605T000000, start_date=20250609T132750, end_date=20250609T132800
[2025-06-09T15:28:00.908+0200] {local_task_job_runner.py:240} INFO - Task exited with return code 0
[2025-06-09T15:28:00.917+0200] {taskinstance.py:3482} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-06-09T15:28:00.928+0200] {local_task_job_runner.py:222} INFO - ::endgroup::
